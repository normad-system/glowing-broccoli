// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

model User {
  id        Int        @id @default(autoincrement())
  email     String     @unique
  name      String?
  password  String
  role      Role       @default(USER)
  bio       String?    @db.Text
  avatar    String?
  
  posts     BlogPost[]
  
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  
  @@index([email])
}

model Category {
  id          Int        @id @default(autoincrement())
  slug        String     @unique
  
  nameKo      String
  nameEn      String
  nameJa      String
  
  descriptionKo String?  @db.Text
  descriptionEn String?  @db.Text
  descriptionJa String?  @db.Text
  
  icon        String?
  color       String?
  order       Int        @default(0)
  
  posts       BlogPost[]
  
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  
  @@index([slug])
  @@index([order])
}

model BlogPost {
  id          Int      @id @default(autoincrement())
  slug        String   @unique
  
  titleKo     String
  titleEn     String
  titleJa     String
  
  excerptKo   String?  @db.Text
  excerptEn   String?  @db.Text
  excerptJa   String?  @db.Text
  
  contentKo   String   @db.Text
  contentEn   String   @db.Text
  contentJa   String   @db.Text
  
  category    Category @relation(fields: [categoryId], references: [id])
  categoryId  Int
  
  metaKeywords String  @db.Text
  difficulty   Difficulty @default(INTERMEDIATE)
  readingTime  Int?
  
  thumbnailUrl String?
  
  relatedServiceId Int?
  
  viewCount    Int      @default(0)
  likeCount    Int      @default(0)
  
  published    Boolean  @default(false)
  publishedAt  DateTime?
  
  authorId     Int
  author       User     @relation(fields: [authorId], references: [id])
  
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  
  @@index([categoryId, publishedAt])
  @@index([slug])
  @@index([published])
}

enum Role {
  USER
  ADMIN
  EDITOR
}

enum Difficulty {
  BEGINNER
  INTERMEDIATE
  ADVANCED
}
